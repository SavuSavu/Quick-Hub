<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HydraBrute - Browser-based Bruteforce Tool</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        .progress-bar {
            transition: width 0.3s ease;
        }
        .log-entry {
            animation: fadeIn 0.3s ease;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .dragover {
            border-color: #3b82f6 !important;
            background-color: #eff6ff !important;
        }
    </style>
</head>
<body class="bg-gray-100 min-h-screen">
    <div class="container mx-auto px-4 py-8">
        <!-- Header -->
        <header class="mb-8">
            <div class="flex items-center justify-between">
                <div>
                    <h1 class="text-3xl font-bold text-gray-800">
                        <i class="fas fa-bolt text-blue-500 mr-2"></i>HydraBrute
                    </h1>
                    <p class="text-gray-600">Browser-based credential bruteforcing tool</p>
                </div>
                <div class="flex items-center space-x-2">
                    <span class="px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-sm font-medium">
                        <i class="fas fa-lock mr-1"></i> Client-side
                    </span>
                    <span class="px-3 py-1 bg-green-100 text-green-800 rounded-full text-sm font-medium">
                        <i class="fas fa-shield-alt mr-1"></i> No server calls
                    </span>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
            <!-- Configuration Panel -->
            <div class="lg:col-span-1 bg-white rounded-lg shadow p-6">
                <h2 class="text-xl font-semibold mb-4 text-gray-800 border-b pb-2">
                    <i class="fas fa-cog mr-2 text-blue-500"></i>Attack Configuration
                </h2>
                
                <!-- Target Selection -->
                <div class="mb-6">
                    <label class="block text-sm font-medium text-gray-700 mb-2">
                        <i class="fas fa-bullseye mr-1 text-red-500"></i>Target(s)
                    </label>
                    <div class="flex space-x-2 mb-2">
                        <button id="singleTargetBtn" class="px-3 py-1 bg-blue-500 text-white rounded text-sm font-medium">Single</button>
                        <button id="multiTargetBtn" class="px-3 py-1 bg-gray-200 text-gray-700 rounded text-sm font-medium">Multiple</button>
                    </div>
                    
                    <div id="singleTargetSection">
                        <input type="text" id="targetInput" placeholder="https://example.com/login" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                    </div>
                    
                    <div id="multiTargetSection" class="hidden mt-2">
                        <div class="border-2 border-dashed border-gray-300 rounded-md p-4 text-center upload-area" id="targetUploadArea">
                            <i class="fas fa-cloud-upload-alt text-3xl text-gray-400 mb-2"></i>
                            <p class="text-sm text-gray-500">Drag & drop target URLs file here</p>
                            <p class="text-xs text-gray-400 mt-1">or</p>
                            <input type="file" id="targetFileInput" class="hidden" accept=".txt,.csv">
                            <button id="targetFileBtn" class="mt-2 px-3 py-1 bg-blue-500 text-white rounded text-sm font-medium">Select File</button>
                            <p class="text-xs text-gray-500 mt-2">One URL per line (max 1000)</p>
                        </div>
                    </div>
                </div>
                
                <!-- Protocol Selection -->
                <div class="mb-6">
                    <label class="block text-sm font-medium text-gray-700 mb-2">
                        <i class="fas fa-network-wired mr-1 text-purple-500"></i>Protocol
                    </label>
                    <select id="protocolSelect" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                        <option value="http-post-form">HTTP POST Form</option>
                        <option value="http-get-form">HTTP GET Form</option>
                        <option value="ftp">FTP</option>
                        <option value="ssh">SSH</option>
                        <option value="smb">SMB</option>
                    </select>
                </div>
                
                <!-- Credential Options -->
                <div class="mb-6">
                    <label class="block text-sm font-medium text-gray-700 mb-2">
                        <i class="fas fa-user-shield mr-1 text-green-500"></i>Credentials
                    </label>
                    
                    <div class="flex space-x-2 mb-3">
                        <button id="defaultCredsBtn" class="px-3 py-1 bg-blue-500 text-white rounded text-sm font-medium">Default</button>
                        <button id="customCredsBtn" class="px-3 py-1 bg-gray-200 text-gray-700 rounded text-sm font-medium">Custom</button>
                    </div>
                    
                    <div id="defaultCredsSection">
                        <div class="flex space-x-2 mb-2">
                            <select id="userlistSelect" class="flex-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                                <option value="top-users">Top 20 Usernames</option>
                                <option value="common-users">Common Usernames (100)</option>
                                <option value="large-users">Large Usernames (1000)</option>
                            </select>
                        </div>
                        
                        <div class="flex space-x-2">
                            <select id="passlistSelect" class="flex-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                                <option value="top-passwords">Top 20 Passwords</option>
                                <option value="common-passwords">Common Passwords (100)</option>
                                <option value="rockyou-light">RockYou Light (1000)</option>
                            </select>
                        </div>
                    </div>
                    
                    <div id="customCredsSection" class="hidden mt-3">
                        <div class="grid grid-cols-2 gap-3">
                            <div class="border-2 border-dashed border-gray-300 rounded-md p-3 text-center upload-area" id="userUploadArea">
                                <i class="fas fa-user text-xl text-gray-400 mb-1"></i>
                                <p class="text-xs text-gray-500">Usernames file</p>
                                <input type="file" id="userFileInput" class="hidden" accept=".txt,.csv">
                                <button id="userFileBtn" class="mt-1 px-2 py-1 bg-blue-500 text-white rounded text-xs font-medium">Select</button>
                            </div>
                            
                            <div class="border-2 border-dashed border-gray-300 rounded-md p-3 text-center upload-area" id="passUploadArea">
                                <i class="fas fa-key text-xl text-gray-400 mb-1"></i>
                                <p class="text-xs text-gray-500">Passwords file</p>
                                <input type="file" id="passFileInput" class="hidden" accept=".txt,.csv">
                                <button id="passFileBtn" class="mt-1 px-2 py-1 bg-blue-500 text-white rounded text-xs font-medium">Select</button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Advanced Options -->
                <div class="mb-6">
                    <div class="flex items-center justify-between mb-2">
                        <label class="text-sm font-medium text-gray-700">
                            <i class="fas fa-sliders-h mr-1 text-yellow-500"></i>Advanced Options
                        </label>
                        <button id="toggleAdvanced" class="text-blue-500 text-sm">
                            <i class="fas fa-chevron-down"></i>
                        </button>
                    </div>
                    
                    <div id="advancedOptions" class="hidden space-y-3">
                        <div>
                            <label class="block text-xs text-gray-500 mb-1">Threads (parallel attempts)</label>
                            <input type="range" id="threadsSlider" min="1" max="10" value="4" class="w-full">
                            <div class="flex justify-between text-xs text-gray-500">
                                <span>1</span>
                                <span id="threadsValue">4</span>
                                <span>10</span>
                            </div>
                        </div>
                        
                        <div>
                            <label class="block text-xs text-gray-500 mb-1">Delay between attempts (ms)</label>
                            <input type="range" id="delaySlider" min="0" max="5000" step="100" value="100" class="w-full">
                            <div class="flex justify-between text-xs text-gray-500">
                                <span>0</span>
                                <span id="delayValue">100</span>
                                <span>5000</span>
                            </div>
                        </div>
                        
                        <div class="flex items-center">
                            <input type="checkbox" id="stopOnSuccess" class="mr-2" checked>
                            <label class="text-xs text-gray-700">Stop on first success</label>
                        </div>
                    </div>
                </div>
                
                <!-- Action Buttons -->
                <div class="space-y-2">
                    <button id="startAttackBtn" class="w-full py-2 px-4 bg-red-600 hover:bg-red-700 text-white font-medium rounded-md flex items-center justify-center">
                        <i class="fas fa-play mr-2"></i> Start Attack
                    </button>
                    <button id="stopAttackBtn" class="w-full py-2 px-4 bg-gray-500 hover:bg-gray-600 text-white font-medium rounded-md hidden">
                        <i class="fas fa-stop mr-2"></i> Stop Attack
                    </button>
                    <button id="resetBtn" class="w-full py-2 px-4 bg-gray-200 hover:bg-gray-300 text-gray-700 font-medium rounded-md">
                        <i class="fas fa-redo mr-2"></i> Reset
                    </button>
                </div>
            </div>
            
            <!-- Results Panel -->
            <div class="lg:col-span-2 bg-white rounded-lg shadow overflow-hidden">
                <div class="border-b p-4 bg-gray-50">
                    <h2 class="text-xl font-semibold text-gray-800">
                        <i class="fas fa-chart-bar mr-2 text-blue-500"></i>Attack Results
                    </h2>
                </div>
                
                <!-- Stats Overview -->
                <div class="grid grid-cols-4 gap-2 p-4 border-b bg-gray-50">
                    <div class="bg-white p-3 rounded shadow-sm text-center">
                        <div class="text-sm text-gray-500">Targets</div>
                        <div id="targetCount" class="text-xl font-bold text-blue-600">0</div>
                    </div>
                    <div class="bg-white p-3 rounded shadow-sm text-center">
                        <div class="text-sm text-gray-500">Attempts</div>
                        <div id="attemptCount" class="text-xl font-bold text-purple-600">0</div>
                    </div>
                    <div class="bg-white p-3 rounded shadow-sm text-center">
                        <div class="text-sm text-gray-500">Success</div>
                        <div id="successCount" class="text-xl font-bold text-green-600">0</div>
                    </div>
                    <div class="bg-white p-3 rounded shadow-sm text-center">
                        <div class="text-sm text-gray-500">Speed</div>
                        <div id="speedCount" class="text-xl font-bold text-yellow-600">0/s</div>
                    </div>
                </div>
                
                <!-- Progress Bar -->
                <div class="p-4 border-b">
                    <div class="flex justify-between text-sm text-gray-600 mb-1">
                        <span>Progress</span>
                        <span id="progressText">0%</span>
                    </div>
                    <div class="w-full bg-gray-200 rounded-full h-2.5">
                        <div id="progressBar" class="progress-bar bg-blue-600 h-2.5 rounded-full" style="width: 0%"></div>
                    </div>
                </div>
                
                <!-- Results Tabs -->
                <div class="border-b">
                    <div class="flex">
                        <button id="logTabBtn" class="px-4 py-2 font-medium text-blue-600 border-b-2 border-blue-600">
                            <i class="fas fa-terminal mr-1"></i> Attack Log
                        </button>
                        <button id="foundTabBtn" class="px-4 py-2 font-medium text-gray-500 hover:text-gray-700">
                            <i class="fas fa-key mr-1"></i> Found Credentials
                        </button>
                        <button id="statsTabBtn" class="px-4 py-2 font-medium text-gray-500 hover:text-gray-700">
                            <i class="fas fa-chart-pie mr-1"></i> Statistics
                        </button>
                    </div>
                </div>
                
                <!-- Tab Content -->
                <div class="h-96 overflow-y-auto">
                    <!-- Attack Log -->
                    <div id="logTabContent" class="p-4 space-y-2">
                        <div class="text-center text-gray-400 py-10">
                            <i class="fas fa-terminal text-4xl mb-2"></i>
                            <p>Attack log will appear here</p>
                        </div>
                    </div>
                    
                    <!-- Found Credentials -->
                    <div id="foundTabContent" class="hidden p-4">
                        <div class="text-center text-gray-400 py-10">
                            <i class="fas fa-key text-4xl mb-2"></i>
                            <p>Found credentials will appear here</p>
                        </div>
                    </div>
                    
                    <!-- Statistics -->
                    <div id="statsTabContent" class="hidden p-4">
                        <div class="text-center text-gray-400 py-10">
                            <i class="fas fa-chart-pie text-4xl mb-2"></i>
                            <p>Statistics will appear here</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Default wordlists
        const wordlists = {
            users: {
                'top-users': ['admin', 'root', 'administrator', 'user', 'test', 'guest', 'info', 'adm', 'mysql', 'user1', 'oracle', 'ftp', 'pi', 'postgres', 'backup', 'git', 'support', 'webmaster', 'www', 'ubuntu'],
                'common-users': ['admin', 'root', 'administrator', 'user', 'test', 'guest', 'info', 'adm', 'mysql', 'user1', 'oracle', 'ftp', 'pi', 'postgres', 'backup', 'git', 'support', 'webmaster', 'www', 'ubuntu', 'demo', 'service', 'sysadmin', 'operator', 'developer', 'manager', 'supervisor', 'superuser', 'tech', 'student', 'teacher', 'sales', 'marketing', 'account', 'finance', 'hr', 'helpdesk', 'security', 'audit', 'monitor', 'backupadmin', 'dbadmin', 'webadmin', 'server', 'client', 'customer', 'visitor', 'anonymous', 'public', 'private', 'internal', 'external', 'temp', 'temporary', 'test1', 'test2', 'test3', 'testuser', 'testadmin', 'testaccount', 'dummy', 'fake', 'example', 'sample', 'standard', 'default', 'generic', 'shared', 'common', 'limited', 'unlimited', 'poweruser', 'normaluser', 'basicuser', 'advanceduser', 'expert', 'novice', 'beginner', 'intermediate', 'professional', 'amateur', 'master', 'slave', 'primary', 'secondary', 'backupuser', 'restore', 'import', 'export', 'upload', 'download', 'sync', 'async', 'batch', 'cron', 'daemon', 'system', 'kernel', 'shell', 'bash', 'zsh', 'fish', 'sh'],
                'large-users': Array(1000).fill().map((_, i) => `user${i+1}`)
            },
            passwords: {
                'top-passwords': ['123456', 'password', '12345678', 'qwerty', '123456789', '12345', '1234', '111111', '1234567', 'dragon', '123123', 'baseball', 'abc123', 'football', 'monkey', 'letmein', 'shadow', 'master', '666666', 'qwertyuiop'],
                'common-passwords': ['123456', 'password', '12345678', 'qwerty', '123456789', '12345', '1234', '111111', '1234567', 'dragon', '123123', 'baseball', 'abc123', 'football', 'monkey', 'letmein', 'shadow', 'master', '666666', 'qwertyuiop', '123321', 'mustang', '1234567890', 'michael', '654321', 'superman', '1qaz2wsx', '7777777', '121212', '000000', 'qazwsx', '123qwe', 'killer', 'trustno1', 'jordan', 'jennifer', 'zxcvbnm', 'asdfgh', 'hunter', 'buster', 'soccer', 'harley', 'batman', 'andrew', 'tigger', 'sunshine', 'iloveyou', 'fuckme', '2000', 'charlie', 'robert', 'thomas', 'hockey', 'ranger', 'daniel', 'starwars', 'klaster', '112233', 'george', 'computer', 'michelle', 'jessica', 'pepper', '1111', 'zxcvbn', '555555', '11111111', '131313', 'freedom', '777777', 'pass', 'maggie', '159753', 'aaaaaa', 'ginger', 'princess', 'joshua', 'cheese', 'amanda', 'summer', 'love', 'ashley', 'nicole', 'chelsea', 'biteme', 'matthew', 'access', 'yankees', '987654321', 'dallas', 'austin', 'thunder', 'taylor', 'matrix', 'minecraft', 'whatever', 'hello', 'hello123', 'fuckyou', 'secret', 'fuck', 'asdf', '123abc', '123asd', 'qwe123', 'qweasd', 'qweqwe', 'asdasd', 'asd123', 'zxc123', 'zxczxc', '1q2w3e', '1q2w3e4r', '1q2w3e4r5t', 'q1w2e3', 'q1w2e3r4', 'q1w2e3r4t5', '1qazxsw2', '!@#$%^', '!@#$%^&*', '!@#$%^&*()', 'qwerty123', 'password1', 'password123', 'admin123', 'welcome123', 'login123', 'pass123', 'passw0rd', 'p@ssword', 'p@ssw0rd', 'pass@123', 'admin@123', 'welcome@123', 'login@123'],
                'rockyou-light': Array(1000).fill().map((_, i) => `pass${i+1}`)
            }
        };

        // State management
        const state = {
            isRunning: false,
            currentAttackId: null,
            targets: [],
            usernames: [],
            passwords: [],
            foundCredentials: [],
            stats: {
                attempts: 0,
                successes: 0,
                startTime: null,
                lastSpeedUpdate: null,
                attemptsSinceLastUpdate: 0
            }
        };

        // DOM elements
        const elements = {
            // Configuration
            singleTargetBtn: document.getElementById('singleTargetBtn'),
            multiTargetBtn: document.getElementById('multiTargetBtn'),
            singleTargetSection: document.getElementById('singleTargetSection'),
            multiTargetSection: document.getElementById('multiTargetSection'),
            targetInput: document.getElementById('targetInput'),
            targetUploadArea: document.getElementById('targetUploadArea'),
            targetFileInput: document.getElementById('targetFileInput'),
            targetFileBtn: document.getElementById('targetFileBtn'),
            
            // Credentials
            defaultCredsBtn: document.getElementById('defaultCredsBtn'),
            customCredsBtn: document.getElementById('customCredsBtn'),
            defaultCredsSection: document.getElementById('defaultCredsSection'),
            customCredsSection: document.getElementById('customCredsSection'),
            userlistSelect: document.getElementById('userlistSelect'),
            passlistSelect: document.getElementById('passlistSelect'),
            userUploadArea: document.getElementById('userUploadArea'),
            userFileInput: document.getElementById('userFileInput'),
            userFileBtn: document.getElementById('userFileBtn'),
            passUploadArea: document.getElementById('passUploadArea'),
            passFileInput: document.getElementById('passFileInput'),
            passFileBtn: document.getElementById('passFileBtn'),
            
            // Advanced
            toggleAdvanced: document.getElementById('toggleAdvanced'),
            advancedOptions: document.getElementById('advancedOptions'),
            threadsSlider: document.getElementById('threadsSlider'),
            threadsValue: document.getElementById('threadsValue'),
            delaySlider: document.getElementById('delaySlider'),
            delayValue: document.getElementById('delayValue'),
            stopOnSuccess: document.getElementById('stopOnSuccess'),
            
            // Actions
            startAttackBtn: document.getElementById('startAttackBtn'),
            stopAttackBtn: document.getElementById('stopAttackBtn'),
            resetBtn: document.getElementById('resetBtn'),
            
            // Results
            targetCount: document.getElementById('targetCount'),
            attemptCount: document.getElementById('attemptCount'),
            successCount: document.getElementById('successCount'),
            speedCount: document.getElementById('speedCount'),
            progressBar: document.getElementById('progressBar'),
            progressText: document.getElementById('progressText'),
            
            // Tabs
            logTabBtn: document.getElementById('logTabBtn'),
            foundTabBtn: document.getElementById('foundTabBtn'),
            statsTabBtn: document.getElementById('statsTabBtn'),
            logTabContent: document.getElementById('logTabContent'),
            foundTabContent: document.getElementById('foundTabContent'),
            statsTabContent: document.getElementById('statsTabContent')
        };

        // Initialize the app
        function init() {
            setupEventListeners();
            updateStatsDisplay();
        }

        // Set up all event listeners
        function setupEventListeners() {
            // Target selection
            elements.singleTargetBtn.addEventListener('click', () => {
                elements.singleTargetBtn.classList.add('bg-blue-500', 'text-white');
                elements.singleTargetBtn.classList.remove('bg-gray-200', 'text-gray-700');
                elements.multiTargetBtn.classList.add('bg-gray-200', 'text-gray-700');
                elements.multiTargetBtn.classList.remove('bg-blue-500', 'text-white');
                elements.singleTargetSection.classList.remove('hidden');
                elements.multiTargetSection.classList.add('hidden');
            });
            
            elements.multiTargetBtn.addEventListener('click', () => {
                elements.multiTargetBtn.classList.add('bg-blue-500', 'text-white');
                elements.multiTargetBtn.classList.remove('bg-gray-200', 'text-gray-700');
                elements.singleTargetBtn.classList.add('bg-gray-200', 'text-gray-700');
                elements.singleTargetBtn.classList.remove('bg-blue-500', 'text-white');
                elements.singleTargetSection.classList.add('hidden');
                elements.multiTargetSection.classList.remove('hidden');
            });
            
            // Credentials selection
            elements.defaultCredsBtn.addEventListener('click', () => {
                elements.defaultCredsBtn.classList.add('bg-blue-500', 'text-white');
                elements.defaultCredsBtn.classList.remove('bg-gray-200', 'text-gray-700');
                elements.customCredsBtn.classList.add('bg-gray-200', 'text-gray-700');
                elements.customCredsBtn.classList.remove('bg-blue-500', 'text-white');
                elements.defaultCredsSection.classList.remove('hidden');
                elements.customCredsSection.classList.add('hidden');
            });
            
            elements.customCredsBtn.addEventListener('click', () => {
                elements.customCredsBtn.classList.add('bg-blue-500', 'text-white');
                elements.customCredsBtn.classList.remove('bg-gray-200', 'text-gray-700');
                elements.defaultCredsBtn.classList.add('bg-gray-200', 'text-gray-700');
                elements.defaultCredsBtn.classList.remove('bg-blue-500', 'text-white');
                elements.defaultCredsSection.classList.add('hidden');
                elements.customCredsSection.classList.remove('hidden');
            });
            
            // Advanced options toggle
            elements.toggleAdvanced.addEventListener('click', () => {
                elements.advancedOptions.classList.toggle('hidden');
                const icon = elements.toggleAdvanced.querySelector('i');
                if (elements.advancedOptions.classList.contains('hidden')) {
                    icon.classList.remove('fa-chevron-up');
                    icon.classList.add('fa-chevron-down');
                } else {
                    icon.classList.remove('fa-chevron-down');
                    icon.classList.add('fa-chevron-up');
                }
            });
            
            // Sliders
            elements.threadsSlider.addEventListener('input', () => {
                elements.threadsValue.textContent = elements.threadsSlider.value;
            });
            
            elements.delaySlider.addEventListener('input', () => {
                elements.delayValue.textContent = elements.delaySlider.value;
            });
            
            // File upload buttons
            elements.targetFileBtn.addEventListener('click', () => elements.targetFileInput.click());
            elements.userFileBtn.addEventListener('click', () => elements.userFileInput.click());
            elements.passFileBtn.addEventListener('click', () => elements.passFileInput.click());
            
            // File input changes
            elements.targetFileInput.addEventListener('change', (e) => handleFileUpload(e, 'targets'));
            elements.userFileInput.addEventListener('change', (e) => handleFileUpload(e, 'users'));
            elements.passFileInput.addEventListener('change', (e) => handleFileUpload(e, 'passwords'));
            
            // Drag and drop
            setupDragAndDrop(elements.targetUploadArea, elements.targetFileInput, 'targets');
            setupDragAndDrop(elements.userUploadArea, elements.userFileInput, 'users');
            setupDragAndDrop(elements.passUploadArea, elements.passFileInput, 'passwords');
            
            // Action buttons
            elements.startAttackBtn.addEventListener('click', startAttack);
            elements.stopAttackBtn.addEventListener('click', stopAttack);
            elements.resetBtn.addEventListener('click', resetApp);
            
            // Tab buttons
            elements.logTabBtn.addEventListener('click', () => switchTab('log'));
            elements.foundTabBtn.addEventListener('click', () => switchTab('found'));
            elements.statsTabBtn.addEventListener('click', () => switchTab('stats'));
        }
        
        // Set up drag and drop for file upload areas
        function setupDragAndDrop(dropArea, fileInput, type) {
            ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
                dropArea.addEventListener(eventName, preventDefaults, false);
            });
            
            function preventDefaults(e) {
                e.preventDefault();
                e.stopPropagation();
            }
            
            ['dragenter', 'dragover'].forEach(eventName => {
                dropArea.addEventListener(eventName, highlight, false);
            });
            
            ['dragleave', 'drop'].forEach(eventName => {
                dropArea.addEventListener(eventName, unhighlight, false);
            });
            
            function highlight() {
                dropArea.classList.add('dragover');
            }
            
            function unhighlight() {
                dropArea.classList.remove('dragover');
            }
            
            dropArea.addEventListener('drop', handleDrop, false);
            
            function handleDrop(e) {
                const dt = e.dataTransfer;
                const files = dt.files;
                fileInput.files = files;
                
                const event = new Event('change');
                fileInput.dispatchEvent(event);
            }
        }
        
        // Handle file uploads
        async function handleFileUpload(event, type) {
            const file = event.target.files[0];
            if (!file) return;
            
            let uploadArea;
            if (type === 'targets') uploadArea = elements.targetUploadArea;
            else if (type === 'users') uploadArea = elements.userUploadArea;
            else if (type === 'passwords') uploadArea = elements.passUploadArea;
            
            try {
                const content = await readFile(file);
                const lines = content.split('\n').filter(line => line.trim() !== '');
                
                // Limit to 1000 lines for demo purposes
                const limitedLines = lines.slice(0, 1000);
                
                // Update UI
                uploadArea.innerHTML = `
                    <i class="fas fa-check-circle text-green-500 text-xl mb-1"></i>
                    <p class="text-xs font-medium">${file.name}</p>
                    <p class="text-xs text-gray-500">${limitedLines.length} items loaded</p>
                `;
                
                // Update state
                if (type === 'targets') {
                    state.targets = limitedLines;
                    elements.targetCount.textContent = limitedLines.length;
                } else if (type === 'users') {
                    state.usernames = limitedLines;
                } else if (type === 'passwords') {
                    state.passwords = limitedLines;
                }
                
                addLogEntry(`Loaded ${limitedLines.length} ${type} from ${file.name}`, 'info');
            } catch (error) {
                addLogEntry(`Error reading ${type} file: ${error.message}`, 'error');
                uploadArea.innerHTML = `
                    <i class="fas fa-times-circle text-red-500 text-xl mb-1"></i>
                    <p class="text-xs font-medium">Error loading file</p>
                    <button class="mt-1 px-2 py-1 bg-blue-500 text-white rounded text-xs font-medium">Retry</button>
                `;
                
                // Set up retry button
                uploadArea.querySelector('button').addEventListener('click', () => {
                    if (type === 'targets') elements.targetFileInput.click();
                    else if (type === 'users') elements.userFileInput.click();
                    else if (type === 'passwords') elements.passFileInput.click();
                });
            }
        }
        
        // Read file content
        function readFile(file) {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                reader.onload = (event) => resolve(event.target.result);
                reader.onerror = (error) => reject(error);
                reader.readAsText(file);
            });
        }
        
        // Start the attack
        function startAttack() {
            if (state.isRunning) return;
            
            // Validate inputs
            if (!validateInputs()) return;
            
            // Prepare attack data
            prepareAttackData();
            
            // Update UI
            state.isRunning = true;
            elements.startAttackBtn.classList.add('hidden');
            elements.stopAttackBtn.classList.remove('hidden');
            
            // Reset stats
            state.stats = {
                attempts: 0,
                successes: 0,
                startTime: new Date(),
                lastSpeedUpdate: new Date(),
                attemptsSinceLastUpdate: 0
            };
            
            // Clear previous results
            elements.logTabContent.innerHTML = '';
            elements.foundTabContent.innerHTML = '';
            elements.statsTabContent.innerHTML = '';
            
            // Generate unique attack ID
            state.currentAttackId = Date.now();
            
            // Start attack simulation
            simulateAttack();
            
            addLogEntry('Attack started', 'success');
        }
        
        // Validate inputs before starting attack
        function validateInputs() {
            // Check targets
            if (elements.singleTargetSection.classList.contains('hidden')) {
                // Multi-target mode
                if (state.targets.length === 0) {
                    addLogEntry('Please upload a targets file or switch to single target mode', 'error');
                    return false;
                }
            } else {
                // Single target mode
                const target = elements.targetInput.value.trim();
                if (!target) {
                    addLogEntry('Please enter a target URL', 'error');
                    return false;
                }
                state.targets = [target];
                elements.targetCount.textContent = '1';
            }
            
            // Check credentials
            if (elements.defaultCredsSection.classList.contains('hidden')) {
                // Custom credentials mode
                if (state.usernames.length === 0 || state.passwords.length === 0) {
                    addLogEntry('Please upload both username and password files', 'error');
                    return false;
                }
            } else {
                // Default credentials mode
                const userlist = elements.userlistSelect.value;
                const passlist = elements.passlistSelect.value;
                
                state.usernames = wordlists.users[userlist];
                state.passwords = wordlists.passwords[passlist];
                
                addLogEntry(`Using ${state.usernames.length} usernames and ${state.passwords.length} passwords from default lists`, 'info');
            }
            
            return true;
        }
        
        // Prepare attack data
        function prepareAttackData() {
            // For demo purposes, we'll just use the first target
            if (state.targets.length > 1) {
                addLogEntry(`Multiple targets detected, using first target for demo: ${state.targets[0]}`, 'info');
            }
            
            // Calculate total attempts
            const totalAttempts = state.usernames.length * state.passwords.length;
            addLogEntry(`Preparing to test ${totalAttempts} credential combinations`, 'info');
        }
        
        // Simulate attack (in a real app, this would make actual requests)
        function simulateAttack() {
            if (!state.isRunning) return;
            
            const attackId = state.currentAttackId;
            const threads = parseInt(elements.threadsSlider.value);
            const delay = parseInt(elements.delaySlider.value);
            const stopOnSuccess = elements.stopOnSuccess.checked;
            
            // Simulate parallel threads
            for (let i = 0; i < threads; i++) {
                setTimeout(() => {
                    if (attackId !== state.currentAttackId) return; // Check if attack was stopped/reset
                    
                    // Get next credential pair
                    const attemptIndex = state.stats.attempts;
                    const usernameIndex = attemptIndex % state.usernames.length;
                    const passwordIndex = Math.floor(attemptIndex / state.usernames.length);
                    
                    if (passwordIndex >= state.passwords.length) {
                        // All passwords tried for all users
                        if (i === 0) { // Only log once
                            addLogEntry('Attack completed - no valid credentials found', 'warning');
                            stopAttack();
                        }
                        return;
                    }
                    
                    const username = state.usernames[usernameIndex];
                    const password = state.passwords[passwordIndex];
                    
                    // Simulate attempt
                    simulateAttempt(username, password, attackId);
                    
                    // Update stats
                    state.stats.attempts++;
                    state.stats.attemptsSinceLastUpdate++;
                    
                    // Update UI
                    updateStatsDisplay();
                    
                    // Check for success (demo: 1% chance of success)
                    const isSuccess = Math.random() < 0.01;
                    if (isSuccess) {
                        state.stats.successes++;
                        state.foundCredentials.push({ username, password });
                        
                        addLogEntry(`SUCCESS! Valid credentials found: ${username}:${password}`, 'success');
                        addFoundCredential(username, password);
                        
                        if (stopOnSuccess) {
                            addLogEntry('Stopping attack as configured (stop on first success)', 'info');
                            stopAttack();
                            return;
                        }
                    }
                    
                    // Schedule next attempt
                    if (state.isRunning && attackId === state.currentAttackId) {
                        setTimeout(() => simulateAttack(), delay);
                    }
                }, i * 100); // Stagger thread starts
            }
        }
        
        // Simulate a single attempt
        function simulateAttempt(username, password, attackId) {
            if (attackId !== state.currentAttackId) return;
            
            // Random response time between 100-1000ms
            const responseTime = Math.floor(Math.random() * 900) + 100;
            
            // Random status code (mostly 401, some 200, 403, etc.)
            const statusCodes = [200, 200, 200, 200, 401, 401, 401, 401, 401, 401, 401, 401, 401, 401, 403, 404, 500];
            const statusCode = statusCodes[Math.floor(Math.random() * statusCodes.length)];
            
            // Log the attempt
            setTimeout(() => {
                if (attackId !== state.currentAttackId) return;
                
                const isSuccess = statusCode === 200;
                const statusClass = isSuccess ? 'text-green-500' : 'text-gray-500';
                
                addLogEntry(`Attempt ${state.stats.attempts + 1}: ${username}:${password} - Status: <span class="${statusClass} font-medium">${statusCode}</span> - ${responseTime}ms`, 'info');
            }, responseTime);
        }
        
        // Stop the attack
        function stopAttack() {
            if (!state.isRunning) return;
            
            state.isRunning = false;
            elements.startAttackBtn.classList.remove('hidden');
            elements.stopAttackBtn.classList.add('hidden');
            
            addLogEntry('Attack stopped', 'warning');
            
            // Calculate duration
            const duration = (new Date() - state.stats.startTime) / 1000;
            addLogEntry(`Attack duration: ${duration.toFixed(1)} seconds`, 'info');
            addLogEntry(`Total attempts: ${state.stats.attempts}`, 'info');
            addLogEntry(`Successful logins: ${state.stats.successes}`, 'info');
            
            if (state.stats.successes === 0) {
                addLogEntry('No valid credentials found', 'warning');
            }
        }
        
        // Reset the app
        function resetApp() {
            stopAttack();
            
            // Reset state
            state.targets = [];
            state.usernames = [];
            state.passwords = [];
            state.foundCredentials = [];
            state.stats = {
                attempts: 0,
                successes: 0,
                startTime: null,
                lastSpeedUpdate: null,
                attemptsSinceLastUpdate: 0
            };
            
            // Reset UI
            elements.targetCount.textContent = '0';
            elements.attemptCount.textContent = '0';
            elements.successCount.textContent = '0';
            elements.speedCount.textContent = '0/s';
            elements.progressBar.style.width = '0%';
            elements.progressText.textContent = '0%';
            
            // Reset file upload areas
            elements.targetUploadArea.innerHTML = `
                <i class="fas fa-cloud-upload-alt text-3xl text-gray-400 mb-2"></i>
                <p class="text-sm text-gray-500">Drag & drop target URLs file here</p>
                <p class="text-xs text-gray-400 mt-1">or</p>
                <input type="file" id="targetFileInput" class="hidden" accept=".txt,.csv">
                <button id="targetFileBtn" class="mt-2 px-3 py-1 bg-blue-500 text-white rounded text-sm font-medium">Select File</button>
                <p class="text-xs text-gray-500 mt-2">One URL per line (max 1000)</p>
            `;
            
            elements.userUploadArea.innerHTML = `
                <i class="fas fa-user text-xl text-gray-400 mb-1"></i>
                <p class="text-xs text-gray-500">Usernames file</p>
                <input type="file" id="userFileInput" class="hidden" accept=".txt,.csv">
                <button id="userFileBtn" class="mt-1 px-2 py-1 bg-blue-500 text-white rounded text-xs font-medium">Select</button>
            `;
            
            elements.passUploadArea.innerHTML = `
                <i class="fas fa-key text-xl text-gray-400 mb-1"></i>
                <p class="text-xs text-gray-500">Passwords file</p>
                <input type="file" id="passFileInput" class="hidden" accept=".txt,.csv">
                <button id="passFileBtn" class="mt-1 px-2 py-1 bg-blue-500 text-white rounded text-xs font-medium">Select</button>
            `;
            
            // Reset file inputs
            elements.targetFileInput.value = '';
            elements.userFileInput.value = '';
            elements.passFileInput.value = '';
            
            // Reset single target input
            elements.targetInput.value = '';
            
            // Reset to default tab
            switchTab('log');
            
            // Re-setup event listeners for reset buttons
            document.getElementById('targetFileBtn').addEventListener('click', () => elements.targetFileInput.click());
            document.getElementById('userFileBtn').addEventListener('click', () => elements.userFileInput.click());
            document.getElementById('passFileBtn').addEventListener('click', () => elements.passFileInput.click());
            
            addLogEntry('Application reset', 'info');
        }
        
        // Update stats display
        function updateStatsDisplay() {
            elements.attemptCount.textContent = state.stats.attempts;
            elements.successCount.textContent = state.stats.successes;
            
            // Calculate speed (attempts per second)
            const now = new Date();
            if (state.stats.startTime) {
                const timeElapsed = (now - state.stats.startTime) / 1000; // seconds
                if (timeElapsed > 0) {
                    const speed = Math.round(state.stats.attempts / timeElapsed);
                    elements.speedCount.textContent = `${speed}/s`;
                }
                
                // Update progress
                const totalPossibleAttempts = state.usernames.length * state.passwords.length;
                if (totalPossibleAttempts > 0) {
                    const progress = Math.min(100, (state.stats.attempts / totalPossibleAttempts) * 100);
                    elements.progressBar.style.width = `${progress}%`;
                    elements.progressText.textContent = `${Math.round(progress)}%`;
                }
            }
            
            // Update every second for smoother speed display
            if (state.isRunning) {
                setTimeout(updateStatsDisplay, 1000);
            }
        }
        
        // Add entry to attack log
        function addLogEntry(message, type = 'info') {
            const now = new Date();
            const timeString = now.toLocaleTimeString();
            
            let typeClass = 'text-gray-500';
            let icon = 'fa-info-circle';
            
            if (type === 'success') {
                typeClass = 'text-green-500';
                icon = 'fa-check-circle';
            } else if (type === 'error') {
                typeClass = 'text-red-500';
                icon = 'fa-times-circle';
            } else if (type === 'warning') {
                typeClass = 'text-yellow-500';
                icon = 'fa-exclamation-circle';
            }
            
            const entry = document.createElement('div');
            entry.className = 'log-entry text-sm flex items-start';
            entry.innerHTML = `
                <span class="text-gray-400 text-xs mr-2 mt-0.5">[${timeString}]</span>
                <i class="fas ${icon} ${typeClass} mr-2 mt-0.5"></i>
                <span>${message}</span>
            `;
            
            elements.logTabContent.prepend(entry);
        }
        
        // Add found credential to results
        function addFoundCredential(username, password) {
            const entry = document.createElement('div');
            entry.className = 'log-entry p-3 bg-green-50 rounded mb-2';
            entry.innerHTML = `
                <div class="flex justify-between items-center">
                    <div>
                        <span class="font-medium text-green-800">${username}</span>
                        <span class="mx-2 text-gray-400">:</span>
                        <span class="font-medium text-green-800">${password}</span>
                    </div>
                    <span class="px-2 py-1 bg-green-100 text-green-800 rounded-full text-xs font-medium">
                        <i class="fas fa-check mr-1"></i> Valid
                    </span>
                </div>
                <div class="mt-1 text-xs text-gray-500">
                    Found at ${new Date().toLocaleTimeString()}
                </div>
            `;
            
            elements.foundTabContent.prepend(entry);
            
            // If on found tab, update immediately, otherwise just add to the list
            if (!elements.foundTabContent.classList.contains('hidden')) {
                elements.foundTabContent.prepend(entry);
            }
        }
        
        // Switch between tabs
        function switchTab(tab) {
            // Update tab buttons
            elements.logTabBtn.classList.remove('text-gray-500', 'hover:text-gray-700');
            elements.foundTabBtn.classList.remove('text-gray-500', 'hover:text-gray-700');
            elements.statsTabBtn.classList.remove('text-gray-500', 'hover:text-gray-700');
            elements.logTabBtn.classList.remove('border-b-2', 'border-blue-600');
            elements.foundTabBtn.classList.remove('border-b-2', 'border-blue-600');
            elements.statsTabBtn.classList.remove('border-b-2', 'border-blue-600');
            
            // Hide all tab contents
            elements.logTabContent.classList.add('hidden');
            elements.foundTabContent.classList.add('hidden');
            elements.statsTabContent.classList.add('hidden');
            
            // Show selected tab
            if (tab === 'log') {
                elements.logTabBtn.classList.add('text-blue-600', 'border-b-2', 'border-blue-600');
                elements.logTabContent.classList.remove('hidden');
            } else if (tab === 'found') {
                elements.foundTabBtn.classList.add('text-blue-600', 'border-b-2', 'border-blue-600');
                elements.foundTabContent.classList.remove('hidden');
                
                // If no credentials found, show message
                if (state.foundCredentials.length === 0) {
                    elements.foundTabContent.innerHTML = `
                        <div class="text-center text-gray-400 py-10">
                            <i class="fas fa-key text-4xl mb-2"></i>
                            <p>No credentials found yet</p>
                        </div>
                    `;
                }
            } else if (tab === 'stats') {
                elements.statsTabBtn.classList.add('text-blue-600', 'border-b-2', 'border-blue-600');
                elements.statsTabContent.classList.remove('hidden');
                
                // Generate stats
                generateStats();
            }
        }
        
        // Generate statistics
        function generateStats() {
            if (!state.stats.startTime) {
                elements.statsTabContent.innerHTML = `
                    <div class="text-center text-gray-400 py-10">
                        <i class="fas fa-chart-pie text-4xl mb-2"></i>
                        <p>No statistics available yet</p>
                    </div>
                `;
                return;
            }
            
            const duration = (new Date() - state.stats.startTime) / 1000; // seconds
            const speed = duration > 0 ? Math.round(state.stats.attempts / duration) : 0;
            const successRate = state.stats.attempts > 0 ? (state.stats.successes / state.stats.attempts * 100).toFixed(2) : 0;
            
            elements.statsTabContent.innerHTML = `
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div class="bg-white p-4 rounded shadow">
                        <h3 class="font-medium text-gray-700 mb-3">Attack Summary</h3>
                        <div class="space-y-2">
                            <div class="flex justify-between text-sm">
                                <span class="text-gray-500">Duration:</span>
                                <span>${duration.toFixed(1)} seconds</span>
                            </div>
                            <div class="flex justify-between text-sm">
                                <span class="text-gray-500">Attempts:</span>
                                <span>${state.stats.attempts}</span>
                            </div>
                            <div class="flex justify-between text-sm">
                                <span class="text-gray-500">Successes:</span>
                                <span class="text-green-500">${state.stats.successes}</span>
                            </div>
                            <div class="flex justify-between text-sm">
                                <span class="text-gray-500">Success rate:</span>
                                <span>${successRate}%</span>
                            </div>
                            <div class="flex justify-between text-sm">
                                <span class="text-gray-500">Average speed:</span>
                                <span>${speed} attempts/second</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-white p-4 rounded shadow">
                        <h3 class="font-medium text-gray-700 mb-3">Configuration</h3>
                        <div class="space-y-2">
                            <div class="flex justify-between text-sm">
                                <span class="text-gray-500">Protocol:</span>
                                <span>${document.getElementById('protocolSelect').value}</span>
                            </div>
                            <div class="flex justify-between text-sm">
                                <span class="text-gray-500">Threads:</span>
                                <span>${elements.threadsSlider.value}</span>
                            </div>
                            <div class="flex justify-between text-sm">
                                <span class="text-gray-500">Delay:</span>
                                <span>${elements.delaySlider.value}ms</span>
                            </div>
                            <div class="flex justify-between text-sm">
                                <span class="text-gray-500">Stop on success:</span>
                                <span>${elements.stopOnSuccess.checked ? 'Yes' : 'No'}</span>
                            </div>
                            <div class="flex justify-between text-sm">
                                <span class="text-gray-500">Targets:</span>
                                <span>${state.targets.length}</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="md:col-span-2 bg-white p-4 rounded shadow">
                        <h3 class="font-medium text-gray-700 mb-3">Credential Stats</h3>
                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <h4 class="text-sm font-medium text-gray-500 mb-2">Top Usernames Tried</h4>
                                <div class="space-y-1">
                                    ${getTopItems(state.usernames, 5).map(item => `
                                        <div class="flex justify-between text-xs">
                                            <span>${item.value}</span>
                                            <span class="text-gray-500">${item.count} tries</span>
                                        </div>
                                    `).join('')}
                                </div>
                            </div>
                            <div>
                                <h4 class="text-sm font-medium text-gray-500 mb-2">Top Passwords Tried</h4>
                                <div class="space-y-1">
                                    ${getTopItems(state.passwords, 5).map(item => `
                                        <div class="flex justify-between text-xs">
                                            <span>${item.value}</span>
                                            <span class="text-gray-500">${item.count} tries</span>
                                        </div>
                                    `).join('')}
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }
        
        // Get top items from an array (for stats)
        function getTopItems(array, count) {
            const frequency = {};
            array.forEach(item => {
                frequency[item] = (frequency[item] || 0) + 1;
            });
            
            return Object.entries(frequency)
                .map(([value, count]) => ({ value, count }))
                .sort((a, b) => b.count - a.count)
                .slice(0, count);
        }
        
        // Initialize the app
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>